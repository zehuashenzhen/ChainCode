/*
 * Copyright IBM Corp. 2018 All Rights Reserved.
 *
 * SPDX-License-Identifier: Apache-2.0
 */

buildscript {
	repositories {
		mavenLocal()
		mavenCentral()
		jcenter()
	}
}

plugins {
	id "java"
	id "eclipse"
	id "application"
}


task printClasspath {
	doLast {
		configurations.testRuntime.each { println it }
	}
}

archivesBaseName = "chaincode"
mainClassName="example.SimpleSample"

run {
	if (project.hasProperty("appArgs")) {
		args = Eval.me(appArgs)
	}
}

sourceSets {
	main {
		java {
			srcDir 'src/main/java'
		}
	}
}

repositories {
	mavenLocal()
	mavenCentral()
}


jar.doFirst {
	destinationDir=file("${buildDir}")
	manifest {
		attributes (
				'Main-Class': mainClassName,
				'Class-Path': configurations.runtime.collect { "libs/"+"$it.name" }.join(' ')
		)
	}
}

task copyToLib(type: Copy) {
	into "$buildDir/libs"
	from configurations.runtime
}
build.finalizedBy(copyToLib)


dependencies {
	compile project(':shim')
	compile 'io.grpc:grpc-all:0.13.2'
	compile 'commons-cli:commons-cli:1.3.1'
	compile 'org.glassfish:javax.json:1.1.0-M1'

}


allprojects {
	repositories {
		jcenter()
	}
}
subprojects {
	group = "org.hyperledger.fabric"
	version = '1.2.0-SNAPSHOT'
}